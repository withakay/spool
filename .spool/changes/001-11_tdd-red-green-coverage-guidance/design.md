## Context

Spool provides (1) template assets installed by `spool init`/`spool update`, and (2) instruction artifacts generated by `spool agent instruction <artifact>`. Today, testing guidance exists but is not consistently emphasized at the proposal/apply boundary, and coverage expectations are implicit rather than first-class and configurable.

## Goals / Non-Goals

**Goals:**

- Ensure proposal/apply instructions explicitly encourage a RED/GREEN/REFACTOR workflow.
- Establish a default coverage target (80%) that is configurable per project.
- Make the guidance appear consistently across harness templates (OpenCode/Claude/Codex/GitHub) and CLI-generated instruction artifacts.

**Non-Goals:**

- Enforce coverage thresholds as a hard gate in CI by default.
- Change the existing cascading-config precedence order.
- Introduce new schema types; remain within `spec-driven`.

## Decisions

- Decision: Store testing guidance defaults in existing JSON config layers.
  - Proposed keys (names are illustrative and can be refined during implementation):
    - `defaults.testing.tdd.workflow`: string, default `"red-green-refactor"`
    - `defaults.testing.coverage.target_percent`: number, default `80`
  - Rationale: Projects already have cascading config; these keys should be optional and non-breaking.
- Decision: Treat coverage target as guidance (not enforcement) in templates/instructions.
  - Rationale: Different repositories have different maturity; enforcement should be opt-in.

## Risks / Trade-offs

- Risk: Guidance becomes noisy or repetitive in instruction outputs. -> Mitigation: keep the TDD section short; allow disabling via config (e.g., `defaults.testing.tdd.enabled=false`).
- Risk: Key naming churn. -> Mitigation: define keys in spec and test them in instruction generation.

## Migration Plan

- Add config keys with defaults; no migration required.
- Existing projects can optionally set overrides in `.spool/config.json`, `.spool.json`, or `spool.json`.

## Open Questions

- Exact config key names and whether to support an explicit `enabled` toggle.
- Whether the coverage guidance should be scoped per crate/workspace or a single repo-wide percent.
